<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Volleybal Rotatiebord</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }
        
        .header {
            background: #2c3e50;
            color: white;
            padding: 10px;
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
        }
        
        .controls {
            background: white;
            padding: 10px;
            display: flex;
            gap: 15px;
            align-items: center;
            justify-content: center;
            border-bottom: 2px solid #ddd;
            flex-wrap: wrap;
        }
        
        .control-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        button {
            padding: 8px 16px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #2980b9;
        }
        
        .toggle-switch {
            display: flex;
            background: #ecf0f1;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .toggle-option {
            padding: 8px 16px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .toggle-option.active {
            background: #3498db;
            color: white;
        }
        
        .main-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        
        .court-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .court {
            position: relative;
            width: 600px;
            height: 400px;
            background: #f4e8d0;
            border: 3px solid #333;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(2, 1fr);
        }
        
        .zone {
            border: 1px solid rgba(0, 0, 0, 0.2);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .zone-label {
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 18px;
            color: rgba(0, 0, 0, 0.3);
            font-weight: bold;
        }
        
        .player-chip {
            position: absolute;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: move;
            user-select: none;
            transition: transform 0.2s;
            z-index: 10;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            font-weight: bold;
            color: white;
            font-size: 16px;
        }
        
        .player-chip.dragging {
            transform: scale(1.1);
            z-index: 100;
            opacity: 0.9;
        }
        
        .player-chip.fault {
            animation: glow 1s ease-in-out infinite;
        }
        
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 10px 5px rgba(255, 0, 0, 0.5); }
            50% { box-shadow: 0 0 20px 10px rgba(255, 0, 0, 0.8); }
        }
        
        .sidebar {
            width: 200px;
            background: white;
            border-left: 2px solid #ddd;
            padding: 20px;
            overflow-y: auto;
        }
        
        .sidebar h3 {
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .player-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .player-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 4px;
            cursor: move;
        }
        
        .player-icon {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: bold;
        }
        
        .status-bar {
            background: white;
            padding: 10px;
            text-align: center;
            border-top: 2px solid #ddd;
        }
        
        .status-ok {
            color: #27ae60;
            font-weight: bold;
        }
        
        .status-fault {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .fault-details {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="header">VOLLEYBAL ROTATIEBORD</div>
    
    <div class="controls">
        <div class="control-group">
            <button onclick="rotate('ccw')">← Roteer</button>
            <button onclick="rotate('cw')">Roteer →</button>
        </div>
        
        <div class="control-group">
            <div class="toggle-switch">
                <div class="toggle-option active" onclick="setMode('serving')">Serveren</div>
                <div class="toggle-option" onclick="setMode('receiving')">Ontvangen</div>
            </div>
        </div>
        
        <div class="control-group">
            <button onclick="snapToZones()">Naar Zones</button>
            <button onclick="resetPositions()">Herstel</button>
        </div>
    </div>
    
    <div class="main-container">
        <div class="court-container">
            <div class="court" id="court">
                <div class="zone" data-zone="4">
                    <div class="zone-label">4</div>
                </div>
                <div class="zone" data-zone="3">
                    <div class="zone-label">3</div>
                </div>
                <div class="zone" data-zone="2">
                    <div class="zone-label">2</div>
                </div>
                <div class="zone" data-zone="5">
                    <div class="zone-label">5</div>
                </div>
                <div class="zone" data-zone="6">
                    <div class="zone-label">6</div>
                </div>
                <div class="zone" data-zone="1">
                    <div class="zone-label">1</div>
                </div>
            </div>
        </div>
        
        <div class="sidebar">
            <h3>Speler Opstelling</h3>
            <div class="player-list" id="playerList"></div>
        </div>
    </div>
    
    <div class="status-bar" id="statusBar">
        <div class="status-ok">✓ Rotatie OK</div>
    </div>
    
    <script>
        // Player data with colors and positions
        const players = [
            { id: 'SV', label: 'SV', color: '#e74c3c', zone: 1 },    // Spelverdeler (Setter)
            { id: 'BP1', label: 'BP1', color: '#27ae60', zone: 2 },  // Buitenaanvaller 1 (Outside Hitter 1)
            { id: 'MV1', label: 'MV1', color: '#f39c12', zone: 3 },  // Midvoor 1 (Middle Blocker 1)
            { id: 'D', label: 'D', color: '#3498db', zone: 4 },      // Diagonaal (Opposite) - diagonal from setter
            { id: 'BP2', label: 'BP2', color: '#9b59b6', zone: 5 },  // Buitenaanvaller 2 (Outside Hitter 2)
            { id: 'MV2', label: 'MV2', color: '#34495e', zone: 6 }   // Midvoor 2 (Middle Blocker 2)
        ];
        
        let currentMode = 'serving';
        let draggedPlayer = null;
        let playerPositions = {};
        
        // Initialize
        function init() {
            createPlayerChips();
            updatePlayerList();
            snapToZones();
        }
        
        // Create player chips on court
        function createPlayerChips() {
            const court = document.getElementById('court');
            
            players.forEach(player => {
                const chip = document.createElement('div');
                chip.className = 'player-chip';
                chip.id = `chip-${player.id}`;
                chip.style.backgroundColor = player.color;
                chip.textContent = player.label;
                chip.draggable = true;
                
                chip.addEventListener('dragstart', handleDragStart);
                chip.addEventListener('dragend', handleDragEnd);
                
                court.appendChild(chip);
                
                // Store initial position
                playerPositions[player.id] = {
                    zone: player.zone,
                    x: 0,
                    y: 0
                };
            });
            
            // Setup court for drop
            court.addEventListener('dragover', handleDragOver);
            court.addEventListener('drop', handleDrop);
        }
        
        // Update player list in sidebar
        function updatePlayerList() {
            const list = document.getElementById('playerList');
            list.innerHTML = '';
            
            // Sort players by zone
            const sortedPlayers = [...players].sort((a, b) => a.zone - b.zone);
            
            sortedPlayers.forEach((player, index) => {
                const item = document.createElement('div');
                item.className = 'player-item';
                item.innerHTML = `
                    <div class="player-icon" style="background: ${player.color}">${player.label}</div>
                    <span>Positie ${player.zone}: ${player.label}</span>
                `;
                list.appendChild(item);
            });
        }
        
        // Drag and drop handlers
        function handleDragStart(e) {
            draggedPlayer = e.target;
            draggedPlayer.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
        }
        
        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
            draggedPlayer = null;
        }
        
        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
        }
        
        function handleDrop(e) {
            e.preventDefault();
            if (!draggedPlayer) return;
            
            const court = document.getElementById('court');
            const rect = court.getBoundingClientRect();
            const x = e.clientX - rect.left - 25; // Center the chip
            const y = e.clientY - rect.top - 25;
            
            // Constrain to court bounds
            const finalX = Math.max(0, Math.min(x, rect.width - 50));
            const finalY = Math.max(0, Math.min(y, rect.height - 50));
            
            draggedPlayer.style.left = finalX + 'px';
            draggedPlayer.style.top = finalY + 'px';
            
            // Update position record
            const playerId = draggedPlayer.id.replace('chip-', '');
            playerPositions[playerId].x = finalX;
            playerPositions[playerId].y = finalY;
            
            checkRotationFaults();
        }
        
        // Rotation functions
        function rotate(direction) {
            players.forEach(player => {
                if (direction === 'cw') {
                    player.zone = player.zone === 1 ? 6 : player.zone - 1;
                } else {
                    player.zone = player.zone === 6 ? 1 : player.zone + 1;
                }
            });
            updatePlayerList();
            checkRotationFaults();
        }
        
        // Snap players to their zones
        function snapToZones() {
            const zones = document.querySelectorAll('.zone');
            
            players.forEach(player => {
                const chip = document.getElementById(`chip-${player.id}`);
                const targetZone = document.querySelector(`[data-zone="${player.zone}"]`);
                
                if (targetZone && chip) {
                    const zoneRect = targetZone.getBoundingClientRect();
                    const courtRect = document.getElementById('court').getBoundingClientRect();
                    
                    const x = (zoneRect.left - courtRect.left) + (zoneRect.width / 2) - 25;
                    const y = (zoneRect.top - courtRect.top) + (zoneRect.height / 2) - 25;
                    
                    chip.style.left = x + 'px';
                    chip.style.top = y + 'px';
                    
                    playerPositions[player.id].x = x;
                    playerPositions[player.id].y = y;
                }
            });
            
            checkRotationFaults();
        }
        
        // Reset to initial positions
        function resetPositions() {
            players.forEach((player, index) => {
                player.zone = index + 1;
            });
            updatePlayerList();
            snapToZones();
        }
        
        // Check for rotation faults
        function checkRotationFaults() {
            const statusBar = document.getElementById('statusBar');
            let faults = [];
            
            // Clear previous fault highlights
            document.querySelectorAll('.player-chip').forEach(chip => {
                chip.classList.remove('fault');
            });
            
            // Get player positions for fault checking
            const positions = {};
            players.forEach(player => {
                const chip = document.getElementById(`chip-${player.id}`);
                positions[player.zone] = {
                    x: parseFloat(chip.style.left),
                    y: parseFloat(chip.style.top),
                    id: player.id
                };
            });
            
            // Check front row (4-3-2) alignment
            if (positions[4] && positions[3] && positions[4].x > positions[3].x) {
                faults.push('Zone 4 moet links van Zone 3 staan');
                document.getElementById(`chip-${positions[4].id}`).classList.add('fault');
                document.getElementById(`chip-${positions[3].id}`).classList.add('fault');
            }
            
            if (positions[3] && positions[2] && positions[3].x > positions[2].x) {
                faults.push('Zone 3 moet links van Zone 2 staan');
                document.getElementById(`chip-${positions[3].id}`).classList.add('fault');
                document.getElementById(`chip-${positions[2].id}`).classList.add('fault');
            }
            
            // Check back row (5-6-1) alignment
            if (positions[5] && positions[6] && positions[5].x > positions[6].x) {
                faults.push('Zone 5 moet links van Zone 6 staan');
                document.getElementById(`chip-${positions[5].id}`).classList.add('fault');
                document.getElementById(`chip-${positions[6].id}`).classList.add('fault');
            }
            
            if (positions[6] && positions[1] && positions[6].x > positions[1].x) {
                faults.push('Zone 6 moet links van Zone 1 staan');
                document.getElementById(`chip-${positions[6].id}`).classList.add('fault');
                document.getElementById(`chip-${positions[1].id}`).classList.add('fault');
            }
            
            // Check front-back alignment
            if (positions[4] && positions[5] && positions[4].y > positions[5].y) {
                faults.push('Zone 4 moet voor Zone 5 staan');
                document.getElementById(`chip-${positions[4].id}`).classList.add('fault');
                document.getElementById(`chip-${positions[5].id}`).classList.add('fault');
            }
            
            if (positions[3] && positions[6] && positions[3].y > positions[6].y) {
                faults.push('Zone 3 moet voor Zone 6 staan');
                document.getElementById(`chip-${positions[3].id}`).classList.add('fault');
                document.getElementById(`chip-${positions[6].id}`).classList.add('fault');
            }
            
            if (positions[2] && positions[1] && positions[2].y > positions[1].y) {
                faults.push('Zone 2 moet voor Zone 1 staan');
                document.getElementById(`chip-${positions[2].id}`).classList.add('fault');
                document.getElementById(`chip-${positions[1].id}`).classList.add('fault');
            }
            
            // Update status bar
            if (faults.length === 0) {
                statusBar.innerHTML = '<div class="status-ok">✓ Rotatie OK</div>';
            } else {
                statusBar.innerHTML = `
                    <div class="status-fault">⚠ Rotatiefout</div>
                    <div class="fault-details">${faults.join(' | ')}</div>
                `;
            }
        }
        
        // Set serving/receiving mode
        function setMode(mode) {
            currentMode = mode;
            document.querySelectorAll('.toggle-option').forEach(option => {
                option.classList.remove('active');
            });
            event.target.classList.add('active');
        }
        
        // Initialize on load
        window.addEventListener('load', init);
    </script>
</body>
</html>